{
  "code": "import BaseProxy from \"./BaseProxy\";\r\nimport AppConstants from \"../../AppConstants\";\r\nimport GameData from \"../data/GameData\";\r\nimport MyLocalStorage from \"../data/MyLocalStorage\";\r\nimport { StorageType } from \"../data/GameConstans\";\r\nimport Helper from \"../../utils/Helper\";\r\nimport TimeTrans from \"../../utils/TimeTrans\";\r\nvar Browser = Laya.Browser;\r\nexport default class LoginProxy extends BaseProxy {\r\n    constructor(proxyName, data) {\r\n        super(LoginProxy.NAME, {});\r\n        this.data.count = 0;\r\n    }\r\n    login(message) {\r\n        if (Browser.onMiniGame) {\r\n            window.platform.i.login((res) => {\r\n                this.loginServer(res.code);\r\n            });\r\n        }\r\n        else {\r\n            this.loginServer(\"\");\r\n        }\r\n    }\r\n    loginServer(code) {\r\n        let hasServer = false;\r\n        if (hasServer) {\r\n            this.send({ url: \"/xxx/xxx\", code: code }, () => {\r\n            });\r\n        }\r\n        else {\r\n            this.data.count = GameData.i.serverList.length;\r\n            GameData.i.serverList.forEach(((value, index, array) => {\r\n                MyLocalStorage.i.read(value.type, this.completed.bind(this));\r\n            }));\r\n        }\r\n    }\r\n    completed(value, key) {\r\n        this.data.count--;\r\n        console.log(`completed---key:${key}`);\r\n        switch (key) {\r\n            case StorageType.USER:\r\n                Helper.i.assignObject(GameData.i.user, value);\r\n                let isSameDay = true;\r\n                if (GameData.i.user.loginDays) {\r\n                    isSameDay = TimeTrans.i.timeStampIsSameDay(GameData.i.user.loginTimeStamp, Browser.now());\r\n                    if (!isSameDay)\r\n                        this.updateEveryDay();\r\n                }\r\n                else {\r\n                    this.updateEveryDay();\r\n                }\r\n                break;\r\n            case StorageType.FRIENDS:\r\n                break;\r\n            case StorageType.SYS:\r\n                break;\r\n        }\r\n        if (this.data.count === 0) {\r\n            this.sendNotification(AppConstants.LOGIN_SUCCESS, { data: \"OK\" });\r\n        }\r\n        else if (this.data.count < 0) {\r\n            console.log(\"错误的消息\");\r\n        }\r\n    }\r\n    updateEveryDay() {\r\n    }\r\n}\r\nLoginProxy.NAME = \"LoginProxy\";\r\n//# sourceMappingURL=LoginProxy.js.map",
  "references": [
    "/jsroads/blog/layademo-puremvc/src/model/proxy/BaseProxy.ts",
    "/jsroads/blog/layademo-puremvc/src/AppConstants.ts",
    "/jsroads/blog/layademo-puremvc/src/model/data/GameData.ts",
    "/jsroads/blog/layademo-puremvc/src/model/data/MyLocalStorage.ts",
    "/jsroads/blog/layademo-puremvc/src/model/data/GameConstans.ts",
    "/jsroads/blog/layademo-puremvc/src/utils/Helper.ts",
    "/jsroads/blog/layademo-puremvc/src/utils/TimeTrans.ts"
  ],
  "map": "{\"version\":3,\"file\":\"LoginProxy.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/model/proxy/LoginProxy.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
